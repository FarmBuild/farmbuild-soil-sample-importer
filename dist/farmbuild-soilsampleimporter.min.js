"use strict";angular.module("farmbuild.soilSampleImporter",["farmbuild.core","farmbuild.farmdata"]).factory("soilSampleImporter",function(soilSampleImporterSession,farmdata,validations,googleAnalyticsImporter,$log){function createDefault(){return $log.info("soil-sample-importer>>>>createDefault"),{dateLastUpdated:"",types:[]}}var soilSampleImporter={farmdata:farmdata},_isDefined=(validations.isPositiveNumber,validations.isDefined);return soilSampleImporter.version="0.1.0",soilSampleImporter.ga=googleAnalyticsImporter,soilSampleImporter.session=soilSampleImporterSession,$log.info("Welcome to Soil Sample Importer... this should only be initialised once! why we see twice in the example?"),soilSampleImporter.find=function(){return soilSampleImporterSession.find()},soilSampleImporter.load=function(farmData){var loaded=farmdata.load(farmData);return $log.info("soil-sample-importer>>>>load>>after farmdata.load"),_isDefined(loaded)?($log.info("soil-sample-importer>>>>load>>check soils"),loaded.hasOwnProperty("soils")||($log.info("soil-sample-importer>>>>load>>no property soils"),loaded.soils={soils:{}}),loaded.soils.hasOwnProperty("soilSamples")||($log.info("soil-sample-importer>>>>load>>no property paddocks"),loaded.soils.soilSamples=createDefault(),loaded=farmdata.update(loaded)),$log.info("soil-sample-importer>>>>load>"+loaded),loaded):void 0},"undefined"==typeof window.farmbuild?window.farmbuild={nutrientcalculator:soilSampleImporter}:window.farmbuild.nutrientcalculator=soilSampleImporter,soilSampleImporter}),angular.module("farmbuild.soilSampleImporter").factory("soilSampleConverter",function($log,farmdata,validations,soilSampleValidator,soilSampleImporterSession){var _isDefined=validations.isDefined,soilSampleConverter=(validations.isArray,validations.isEmpty,{});return soilSampleConverter.toSoilSampleResults=function(farmData){if(!soilSampleValidator.isSoilSampleResultDefined(farmData))return $log.info("soilSampleValidator.isSoilSampleResultDefined"),{dateLastUpdated:new Date,columns:[],paddockResults:[]};var soils=farmData.soils,soilSampleResults=soils.sampleResults,updatedDate=soilSampleResults.dateLastUpdated;_isDefined(updatedDate)||(updatedDate=new Date);var csvColumns=soilSampleResults.columns;$log.info("soilSampleConverter.toSoilSampleResults>>csvColumns "+csvColumns);var paddocks=farmData.paddocks;$log.info("soilSampleConverter.toSoilSampleResults>>paddocks "+paddocks);for(var paddockResult=[],i=0;i<paddocks.length;i++){var singlePaddock=paddocks[i],singleSampleResult={};if(singleSampleResult.name=singlePaddock.name,singleSampleResult.results=[],_isDefined(singlePaddock.soils)){var paddickSoil=singlePaddock.soils;_isDefined(paddickSoil.sampleResults)&&(singleSampleResult.results=paddickSoil.sampleResults)}paddockResult.push(singleSampleResult)}return{dateLastUpdated:new Date,columns:csvColumns,paddockResults:paddockResult}},soilSampleConverter.toFarmData=function(farmData,sampleResults){},soilSampleConverter}),angular.module("farmbuild.soilSampleImporter").factory("googleAnalyticsImporter",function($log,validations,googleAnalytics){{var googleAnalyticsImporter={},api="farmbuild-dairy-nutrient-calculator";validations.isDefined}return googleAnalyticsImporter.track=function(clientName){$log.info("googleAnalyticsImporter.track clientName: %s",clientName),googleAnalytics.track(api,clientName)},googleAnalyticsImporter}),angular.module("farmbuild.soilSampleImporter").factory("soilSampleImporterSession",function($log,farmdata,validations){function load(){var root=farmdata.session.find();return _isDefined(root)?root.soilSampleImporter:void 0}function save(toSave){var farmData=farmdata.session.find();return _isDefined(farmData)?(farmData.dateLastUpdated=new Date,farmData.soilSampleImporter=toSave,farmdata.session.save(farmData),toSave):void $log.error("Unable to find the farmData in the session!")}var soilSampleImporterSession={},_isDefined=validations.isDefined;return soilSampleImporterSession.saveSection=function(section,value){var loaded=load();return _isDefined(loaded)?(loaded[section]=value,save(loaded)):($log.error("Unable to find an existing farmData! please create then save."),soilSampleImporterSession)},soilSampleImporterSession.save=save,soilSampleImporterSession.loadSection=function(section){var loaded=load();return loaded?loaded[section]:null},soilSampleImporterSession.isLoadFlagSet=function(location){var load=!1;return location.href.split("?").length>1&&0===location.href.split("?")[1].indexOf("load")&&(load="true"===location.href.split("?")[1].split("=")[1]),load},soilSampleImporterSession.find=function(){return farmdata.session.find()},soilSampleImporterSession}),angular.module("farmbuild.soilSampleImporter").factory("soilSampleValidator",function($log,farmdata,validations){{var soilSampleValidator={},_isDefined=validations.isDefined;validations.isArray}return soilSampleValidator.isSoilSampleResultDefined=function(farmData){var soils=farmData.soils;if(!_isDefined(soils))return!1;var soilSampleResults=soils.sampleResults;if(!_isDefined(soilSampleResults))return!1;var csvColumns=soilSampleResults.columns;if(!_isDefined(csvColumns))return!1;if(!_isDefined(farmData.paddocks))return!1;var paddocks=farmData.paddocks[0];return _isDefined(paddocks.soils)?!0:!1},soilSampleValidator}),angular.module("farmbuild.soilSampleImporter").run(function(soilSampleImporter){}),angular.injector(["ng","farmbuild.soilSampleImporter"]);
//# sourceMappingURL=farmbuild-nutrientcalculator.min.js.map